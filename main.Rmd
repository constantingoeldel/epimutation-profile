---
title: "main"
author: "Constantin Goeldel"
date: "`r Sys.Date()`"
output: html_document
---

# The epimutation profile of gbmGenes

This script analyses patterns in epimutation rates in gene-body-methylated genes. The epimutation rates are estimated using [AlphaBeta](https://github.com/jlab-code/AlphaBeta)

## Install dependencies
```{r include=FALSE}
if (!requireNamespace("BiocManager", quietly = TRUE ))
    install.install.packages("BiocManager")
BiocManager::install(version = "3.16")

BiocManager::install("AlphaBeta")
BiocManager::install("data.table")
BiocManager::install("dplyr")
remotes::install_github("extendr/rextendr")
library(rextendr)
```



## Estimate epimutation rate

```{r}
nodeFile = "nodelist.fn"
edgeFile = "edgelist.fn"
setwd("/mnt/extStorage/constantin/epimutation-profile")
run.alphabeta.new(nodelist=nodeFile,
                  edelist=edgeFile,
                  name="epimutation_rate_estimation",
                  input.dir="/mnt/extStorage/constantin/epimutation-profile/",
                  output.dir="/mnt/extStorage/constantin/epimutation-profile/")
```


## Estimate epimutation rate per window

```{r}
window_size = 5
for (i in seq(0, 100, by=window_size)) {
print(i)
nodeFile = "nodelist.fn"
edgeFile = "edgelist.fn"
setwd(sprintf("/mnt/extStorage/constantin/windows/%s", i))
name = sprintf("epimutation_rate_estimation_window_%s",i)
directory = sprintf("/mnt/extStorage/constantin/windows/%s/", i)
run.alphabeta.new(nodelist=nodeFile,
                  edelist=edgeFile,
                  name=name,
                  input.dir=directory,
                  output.dir=directory)
print("Finished calculating epimutation rate for window")
}
```




